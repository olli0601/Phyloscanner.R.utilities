<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Oliver Ratmann" />

<meta name="date" content="2018-10-21" />

<title>Dating trees with ancestral states (phyloscanner + treedater)</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Dating trees with ancestral states (phyloscanner + treedater)</h1>
<h4 class="author">Oliver Ratmann</h4>
<h4 class="date">2018-10-21</h4>



<style type="text/css">
pre code, pre, code {
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}
</style>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This vignette illustrates new code that I added to the <code>ordev</code> branch of <code>phyloscanner</code> in order to date trees in <em>phyloscanner</em> format.</p>
<p>The rationale and steps in the analysis below are as follows:</p>
<ul>
<li>Many LANL sequences do not have a sampling date available, but we still like to use them in parsimony-based ancestral state reconstructions</li>
<li>We perform parsimony-based ancestral state reconstructions with all LANL sequences using <em>phyloscanner</em></li>
<li>Then we remove taxa without sampling dates. We cannot simply use <code>ape:::drop.tip</code> because the function returns a new tree structure, and so our previous ancestral state reconstructions are meaningless. Luckily, <code>phytools</code> has functionality to drop tips and extract clades of trees with ancestral state reconstructions, though the trees need to be in <code>SIMMAP</code> format. So all we need to do is to cast the <em>phyloscanner</em> trees into <code>SIMMAP</code> format, and then we can drop taxa. The end result is a tree without sampling dates, and with ancestral state reconstructions preserved.</li>
<li>The next step is to date the tree, with <code>treedater</code>.</li>
<li>Since <code>treedater</code> keeps the tree topology intact, the edge index in the dated tree is the same as the edge index in the undated tree. This means we can copy the branch lengths of the dated tree into the previous undated tree. The end result is a dated tree, with dropped tips without sampling information, and with ancestral state reconstructions.</li>
<li>Now we can extract King County subgraphs, that are dated. These subgraphs correspond to transmission chains that circulate in King County.<br />
</li>
<li>Note that we have sampling dates for all sequences from King County, so the above steps retain the entire King County data.</li>
<li>The next step will be to perform phylodynamic analysis on the data that corresponds to transmission chains in Seattle.</li>
</ul>
</div>
<div id="getting-started" class="section level2">
<h2>Getting started</h2>
<p>You need to set the following input arguments:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># file inputs infile.seqinfo &lt;- &#39;~/Box Sync/OR_Work/Seattle/PHSKC-2019_07_24/sequences_meta.rds&#39; </span><span class="al">NOTE</span><span class="co">: new file above not compatible with old data: cannot find sequence ids.</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3">infile.seqinfo &lt;-<span class="st"> &quot;~/Box Sync/OR_Work/Seattle/PHSKC-2018-07-09/sequences_meta.rds&quot;</span></a>
<a class="sourceLine" id="cb1-4" title="4">indir.trees &lt;-<span class="st"> &quot;~/Box Sync/OR_Work/Seattle/analysis_190723/trees&quot;</span></a>
<a class="sourceLine" id="cb1-5" title="5">indir.phsc &lt;-<span class="st"> &quot;~/Box Sync/OR_Work/Seattle/analysis_190723/phyloscanner_HSX&quot;</span></a></code></pre></div>
<p>Make sure you have the ordev branch of phyloscannerR installed:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co">#   required packages</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">require</span>(data.table)     </a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">require</span>(tidyverse)  </a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw">require</span>(ape)    </a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw">require</span>(phytools)</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw">require</span>(treedater)</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="kw">require</span>(phyloscannerR)</a>
<a class="sourceLine" id="cb2-8" title="8">    </a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#   file inputs</span></a>
<a class="sourceLine" id="cb2-10" title="10">infiles.trees &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">F=</span><span class="kw">list.files</span>(indir.trees, <span class="dt">pattern=</span><span class="st">&#39;rerooted</span><span class="ch">\\</span><span class="st">.newick$&#39;</span>, <span class="dt">recursive=</span><span class="ot">TRUE</span>, <span class="dt">full.names=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb2-11" title="11">infiles.phsc &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">F=</span><span class="kw">list.files</span>(indir.phsc, <span class="dt">pattern=</span><span class="st">&#39;workspace.rda$&#39;</span>, <span class="dt">full.names=</span><span class="ot">TRUE</span>, <span class="dt">recursive=</span><span class="ot">TRUE</span>)) </a>
<a class="sourceLine" id="cb2-12" title="12"></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#   input args needed for tree.dater</span></a>
<a class="sourceLine" id="cb2-14" title="14">alignment.length &lt;-<span class="st"> </span><span class="dv">1100</span></a>
<a class="sourceLine" id="cb2-15" title="15"></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#</span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co"># read Seattle sampling data </span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co"># define initial guess on actual sampling date as midpoint </span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="co"># define upper/lower limits on actual sampling date</span></a>
<a class="sourceLine" id="cb2-20" title="20">dseq &lt;-<span class="st"> </span><span class="kw">readRDS</span>(infile.seqinfo) </a>
<a class="sourceLine" id="cb2-21" title="21">dseq &lt;-<span class="st"> </span>dseq <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-22" title="22"><span class="st">            </span><span class="kw">select</span>(seqID, newnum, type, seqy, seqm) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="st">            </span><span class="kw">mutate</span>( <span class="dt">SEQ_DATE:=</span> seqy <span class="op">+</span><span class="st"> </span>(seqm<span class="dv">-1</span>)<span class="op">/</span><span class="dv">12</span> <span class="op">+</span><span class="st"> </span><span class="dv">15</span><span class="op">/</span><span class="dv">365</span>,</a>
<a class="sourceLine" id="cb2-24" title="24">                    <span class="dt">SEQ_DATE_LOWER:=</span> seqy <span class="op">+</span><span class="st"> </span>(seqm<span class="dv">-1</span>)<span class="op">/</span><span class="dv">12</span>,</a>
<a class="sourceLine" id="cb2-25" title="25">                    <span class="dt">SEQ_DATE_UPPER:=</span> seqy <span class="op">+</span><span class="st"> </span>(seqm<span class="dv">-1</span>)<span class="op">/</span><span class="dv">12</span> <span class="op">+</span><span class="st"> </span><span class="dv">30</span><span class="op">/</span><span class="dv">365</span></a>
<a class="sourceLine" id="cb2-26" title="26">                    ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-27" title="27"><span class="st">            </span><span class="kw">select</span>(<span class="op">-</span>seqy, <span class="op">-</span>seqm) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="st">            </span><span class="kw">rename</span>(<span class="dt">TAXA=</span> seqID, <span class="dt">PID=</span> newnum, <span class="dt">TYPE=</span>type)</a>
<a class="sourceLine" id="cb2-29" title="29">dseq &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(dseq)</a></code></pre></div>
</div>
<div id="code-to-date-a-phyloscanner-tree" class="section level2">
<h2>Code to date a phyloscanner tree</h2>
<p>The following code chunk will:</p>
<ul>
<li>load a tree with ancestral states in phyloscanner format</li>
<li>remove taxa without sampling dates</li>
<li>date the tree</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co">#</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#   read tree with ancestral state reconstructions in phyloscanner format</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#</span></a>
<a class="sourceLine" id="cb3-4" title="4">i&lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-5" title="5">infile &lt;-<span class="st"> </span>infiles.phsc[i,F] </a>
<a class="sourceLine" id="cb3-6" title="6"><span class="kw">load</span>(infile)</a>
<a class="sourceLine" id="cb3-7" title="7">ph &lt;-<span class="st"> </span>phyloscanner.trees[[<span class="dv">1</span>]][[<span class="st">&#39;tree&#39;</span>]]</a>
<a class="sourceLine" id="cb3-8" title="8"><span class="kw">stopifnot</span>( <span class="op">!</span><span class="kw">any</span>( ph<span class="op">$</span>tip.label<span class="op">==</span><span class="st">&#39;&#39;</span> ) )</a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#   drop tips without sequence dates, </span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#   while conserving the ancestral state reconstructions</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#</span></a>
<a class="sourceLine" id="cb3-14" title="14"></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#   extract taxa names</span></a>
<a class="sourceLine" id="cb3-16" title="16">dph &lt;-<span class="st"> </span><span class="kw">data.table</span>(  <span class="dt">TAXA_LABEL=</span>ph<span class="op">$</span>tip.label,</a>
<a class="sourceLine" id="cb3-17" title="17">        <span class="dt">TAXA=</span> <span class="kw">gsub</span>( <span class="st">&#39;^(PR/RT-[0-9]+).*&#39;</span>,<span class="st">&#39;</span><span class="ch">\\</span><span class="st">1&#39;</span>,</a>
<a class="sourceLine" id="cb3-18" title="18">                <span class="kw">gsub</span>(<span class="st">&#39;^[^_]+___(.*)&#39;</span>,<span class="st">&#39;</span><span class="ch">\\</span><span class="st">1&#39;</span>,</a>
<a class="sourceLine" id="cb3-19" title="19">                  ph<span class="op">$</span>tip.label)),</a>
<a class="sourceLine" id="cb3-20" title="20">        <span class="dt">TAXA_ID=</span> <span class="kw">seq_along</span>(ph<span class="op">$</span>tip.label))</a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">#   add Seattle sequence dates</span></a>
<a class="sourceLine" id="cb3-22" title="22">dph &lt;-<span class="st"> </span><span class="kw">merge</span>(dph, dseq, <span class="dt">by=</span><span class="st">&#39;TAXA&#39;</span>, <span class="dt">all.x=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#   extract GenBank sequence dates from taxa names where possible </span></a>
<a class="sourceLine" id="cb3-24" title="24">dph[, GENBANK_ID<span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;^([^</span><span class="ch">\\</span><span class="st">.]+)</span><span class="ch">\\</span><span class="st">.([^</span><span class="ch">\\</span><span class="st">.]+)</span><span class="ch">\\</span><span class="st">.([^</span><span class="ch">\\</span><span class="st">.]+)</span><span class="ch">\\</span><span class="st">.([^</span><span class="ch">\\</span><span class="st">.]+)</span><span class="ch">\\</span><span class="st">.([^</span><span class="ch">\\</span><span class="st">.]+)</span><span class="ch">\\</span><span class="st">.([^</span><span class="ch">\\</span><span class="st">.]+)$&#39;</span>,<span class="st">&#39;</span><span class="ch">\\</span><span class="st">5&#39;</span>,TAXA)]</a>
<a class="sourceLine" id="cb3-25" title="25">dph[, GENBANK_SEQDATE<span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">gsub</span>(<span class="st">&#39;^([^</span><span class="ch">\\</span><span class="st">.]+)</span><span class="ch">\\</span><span class="st">.([^</span><span class="ch">\\</span><span class="st">.]+)</span><span class="ch">\\</span><span class="st">.([^</span><span class="ch">\\</span><span class="st">.]+)</span><span class="ch">\\</span><span class="st">.([^</span><span class="ch">\\</span><span class="st">.]+)</span><span class="ch">\\</span><span class="st">.([^</span><span class="ch">\\</span><span class="st">.]+)</span><span class="ch">\\</span><span class="st">.([^</span><span class="ch">\\</span><span class="st">.]+)$&#39;</span>,<span class="st">&#39;</span><span class="ch">\\</span><span class="st">3&#39;</span>,TAXA)]</a>
<a class="sourceLine" id="cb3-26" title="26"><span class="kw">set</span>(dph, dph[, <span class="kw">which</span>(GENBANK_SEQDATE<span class="op">==</span><span class="st">&#39;-&#39;</span> <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(SEQ_DATE))],<span class="st">&#39;GENBANK_SEQDATE&#39;</span>,<span class="ot">NA_character_</span>) </a>
<a class="sourceLine" id="cb3-27" title="27"><span class="kw">set</span>(dph, <span class="ot">NULL</span>, <span class="st">&#39;GENBANK_SEQDATE_LOWER&#39;</span>, dph[, <span class="kw">as.numeric</span>(GENBANK_SEQDATE) ])</a>
<a class="sourceLine" id="cb3-28" title="28"><span class="kw">set</span>(dph, <span class="ot">NULL</span>, <span class="st">&#39;GENBANK_SEQDATE_UPPER&#39;</span>, dph[, <span class="kw">as.numeric</span>(GENBANK_SEQDATE) <span class="op">+</span><span class="st"> </span><span class="dv">364</span><span class="op">/</span><span class="dv">365</span> ])  </a>
<a class="sourceLine" id="cb3-29" title="29"><span class="kw">set</span>(dph, <span class="ot">NULL</span>, <span class="st">&#39;GENBANK_SEQDATE&#39;</span>, dph[, <span class="kw">as.numeric</span>(GENBANK_SEQDATE) <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span> ])</a>
<a class="sourceLine" id="cb3-30" title="30">tmp &lt;-<span class="st"> </span>dph[, <span class="kw">which</span>(<span class="kw">is.na</span>(SEQ_DATE))]</a>
<a class="sourceLine" id="cb3-31" title="31"><span class="kw">set</span>(dph, tmp, <span class="st">&#39;SEQ_DATE&#39;</span>, dph[tmp, GENBANK_SEQDATE])</a>
<a class="sourceLine" id="cb3-32" title="32"><span class="kw">set</span>(dph, tmp, <span class="st">&#39;SEQ_DATE_LOWER&#39;</span>, dph[tmp, GENBANK_SEQDATE_LOWER])</a>
<a class="sourceLine" id="cb3-33" title="33"><span class="kw">set</span>(dph, tmp, <span class="st">&#39;SEQ_DATE_UPPER&#39;</span>, dph[tmp, GENBANK_SEQDATE_UPPER])</a>
<a class="sourceLine" id="cb3-34" title="34"><span class="kw">set</span>(dph, <span class="ot">NULL</span>, <span class="kw">c</span>(<span class="st">&#39;GENBANK_SEQDATE&#39;</span>,<span class="st">&#39;GENBANK_SEQDATE_LOWER&#39;</span>,<span class="st">&#39;GENBANK_SEQDATE_UPPER&#39;</span>), <span class="ot">NULL</span>)  </a>
<a class="sourceLine" id="cb3-35" title="35"><span class="co">#   drop tips </span></a>
<a class="sourceLine" id="cb3-36" title="36">dph.old &lt;-<span class="st"> </span><span class="kw">subset</span>(dph, <span class="dt">select=</span><span class="kw">c</span>(TAXA, SEQ_DATE, SEQ_DATE_LOWER, SEQ_DATE_UPPER))    </a>
<a class="sourceLine" id="cb3-37" title="37">tmp &lt;-<span class="st"> </span><span class="kw">subset</span>(dph, <span class="kw">is.na</span>(SEQ_DATE))[, TAXA_ID]</a>
<a class="sourceLine" id="cb3-38" title="38"><span class="kw">cat</span>(<span class="st">&#39;Dropping tips without sampling date from &#39;</span>, infile,<span class="st">&#39; n=&#39;</span>, <span class="kw">length</span>(tmp), <span class="st">&#39;of Ntips=&#39;</span>, <span class="kw">Ntip</span>(ph), <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb3-39" title="39"><span class="co">#&gt; Dropping tips without sampling date from  /Users/Oliver/Box Sync/OR_Work/Seattle/analysis_190723/phyloscanner_HSX/Subtype_01_AE_0_workspace.rda  n= 58 of Ntips= 547</span></a>
<a class="sourceLine" id="cb3-40" title="40">ph &lt;-<span class="st"> </span><span class="kw">phyloscanner.to.simmap</span>(ph)    </a>
<a class="sourceLine" id="cb3-41" title="41">ph &lt;-<span class="st"> </span>phytools<span class="op">:::</span><span class="kw">drop.tip.simmap</span>(ph, ph<span class="op">$</span>tip.label[tmp])</a>
<a class="sourceLine" id="cb3-42" title="42">ph &lt;-<span class="st"> </span><span class="kw">simmap.to.phyloscanner</span>(ph)</a>
<a class="sourceLine" id="cb3-43" title="43"></a>
<a class="sourceLine" id="cb3-44" title="44"></a>
<a class="sourceLine" id="cb3-45" title="45"><span class="co">#</span></a>
<a class="sourceLine" id="cb3-46" title="46"><span class="co">#   date tree</span></a>
<a class="sourceLine" id="cb3-47" title="47"><span class="co">#   </span></a>
<a class="sourceLine" id="cb3-48" title="48"></a>
<a class="sourceLine" id="cb3-49" title="49"><span class="co">#   make data.table of sequence sampling times</span></a>
<a class="sourceLine" id="cb3-50" title="50">dph &lt;-<span class="st"> </span><span class="kw">data.table</span>(  <span class="dt">TAXA_LABEL=</span>ph<span class="op">$</span>tip.label,</a>
<a class="sourceLine" id="cb3-51" title="51">        <span class="dt">TAXA=</span> <span class="kw">gsub</span>(<span class="st">&#39;^(PR/RT-[0-9]+).*&#39;</span>,<span class="st">&#39;</span><span class="ch">\\</span><span class="st">1&#39;</span>,</a>
<a class="sourceLine" id="cb3-52" title="52">                <span class="kw">gsub</span>(<span class="st">&#39;^[^_]+___(.*)&#39;</span>,<span class="st">&#39;</span><span class="ch">\\</span><span class="st">1&#39;</span>,</a>
<a class="sourceLine" id="cb3-53" title="53">                  ph<span class="op">$</span>tip.label)),</a>
<a class="sourceLine" id="cb3-54" title="54">        <span class="dt">TAXA_ID=</span> <span class="kw">seq_along</span>(ph<span class="op">$</span>tip.label))</a>
<a class="sourceLine" id="cb3-55" title="55">dph &lt;-<span class="st"> </span><span class="kw">merge</span>(dph, dph.old, <span class="dt">by=</span> <span class="st">&#39;TAXA&#39;</span>)</a>
<a class="sourceLine" id="cb3-56" title="56"><span class="kw">stopifnot</span>( <span class="op">!</span><span class="kw">any</span>(<span class="kw">is.na</span>(dph<span class="op">$</span>SEQ_DATE)) )</a>
<a class="sourceLine" id="cb3-57" title="57">dph &lt;-<span class="st"> </span>dph[<span class="kw">order</span>(TAXA_ID),]</a>
<a class="sourceLine" id="cb3-58" title="58"><span class="co">#   get into format needed for tree.dater   </span></a>
<a class="sourceLine" id="cb3-59" title="59">sampling.times.init &lt;-<span class="st"> </span>dph<span class="op">$</span>SEQ_DATE</a>
<a class="sourceLine" id="cb3-60" title="60"><span class="kw">names</span>(sampling.times.init) &lt;-<span class="st"> </span>dph<span class="op">$</span>TAXA_LABEL</a>
<a class="sourceLine" id="cb3-61" title="61">sampling.times.bounds &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">subset</span>(dph, <span class="dt">select=</span><span class="kw">c</span>(SEQ_DATE_LOWER, SEQ_DATE_UPPER)))</a>
<a class="sourceLine" id="cb3-62" title="62"><span class="kw">rownames</span>(sampling.times.bounds) &lt;-<span class="st"> </span>dph<span class="op">$</span>TAXA_LABEL       </a>
<a class="sourceLine" id="cb3-63" title="63"><span class="kw">colnames</span>(sampling.times.bounds) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;lower&#39;</span>,<span class="st">&#39;upper&#39;</span>)</a>
<a class="sourceLine" id="cb3-64" title="64"><span class="co">#   date tree</span></a>
<a class="sourceLine" id="cb3-65" title="65">ph.dated &lt;-<span class="st"> </span><span class="kw">dater</span>(  ph, </a>
<a class="sourceLine" id="cb3-66" title="66">                    sampling.times.init, </a>
<a class="sourceLine" id="cb3-67" title="67">                    alignment.length, </a>
<a class="sourceLine" id="cb3-68" title="68">                    <span class="dt">numStartConditions=</span><span class="dv">1</span>, </a>
<a class="sourceLine" id="cb3-69" title="69">                    <span class="dt">estimateSampleTimes=</span>sampling.times.bounds )</a>
<a class="sourceLine" id="cb3-70" title="70"><span class="co">#&gt; Note: Minimum temporal branch length  (*minblen*) set to 0.00564916753041806. Increase *minblen* in the event of convergence failures. </span></a>
<a class="sourceLine" id="cb3-71" title="71"><span class="co">#&gt; Tree is rooted. Not estimating root position.</span></a>
<a class="sourceLine" id="cb3-72" title="72"><span class="co">#&gt; Warning in mgcv::pcls(M): initial point very close to some inequality constraints</span></a>
<a class="sourceLine" id="cb3-73" title="73"></a>
<a class="sourceLine" id="cb3-74" title="74"><span class="co">#&gt; Warning in mgcv::pcls(M): initial point very close to some inequality constraints</span></a>
<a class="sourceLine" id="cb3-75" title="75"><span class="kw">stopifnot</span>( <span class="kw">all</span>(  ph.dated<span class="op">$</span>tip.label <span class="op">==</span><span class="st"> </span>ph<span class="op">$</span>tip.label ) )</a>
<a class="sourceLine" id="cb3-76" title="76"><span class="kw">stopifnot</span>( <span class="kw">all</span>( ph.dated<span class="op">$</span>edge <span class="op">==</span><span class="st"> </span>ph<span class="op">$</span>edge ) )</a>
<a class="sourceLine" id="cb3-77" title="77"><span class="co">#   since the tree topology is unchanged, we can copy</span></a>
<a class="sourceLine" id="cb3-78" title="78"><span class="co">#   the branch lenghts in units of time onto the original tree</span></a>
<a class="sourceLine" id="cb3-79" title="79"><span class="co">#   that has the ancestral state reconstructions</span></a>
<a class="sourceLine" id="cb3-80" title="80">ph<span class="op">$</span>edge.length &lt;-<span class="st"> </span>ph.dated<span class="op">$</span>edge.length</a></code></pre></div>
<p>Let us also print and save the output:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># plot dated tree to spot obvious errors</span></a>
<a class="sourceLine" id="cb4-2" title="2">outfile &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;workspace</span><span class="ch">\\</span><span class="st">.rda&quot;</span>, <span class="st">&quot;annotated_dated_tree.pdf&quot;</span>, infile)</a>
<a class="sourceLine" id="cb4-3" title="3">tmp &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>)</a>
<a class="sourceLine" id="cb4-4" title="4">tmp[[<span class="st">&quot;tree&quot;</span>]] &lt;-<span class="st"> </span>ph</a>
<a class="sourceLine" id="cb4-5" title="5">tmp[[<span class="st">&quot;tree&quot;</span>]][[<span class="st">&quot;node.states&quot;</span>]] &lt;-<span class="st"> </span>tmp[[<span class="st">&quot;tree&quot;</span>]][[<span class="st">&quot;mapped.edge&quot;</span>]] &lt;-<span class="st"> </span>tmp[[<span class="st">&quot;tree&quot;</span>]][[<span class="st">&quot;maps&quot;</span>]] &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="kw">attr</span>(tmp[[<span class="st">&quot;tree&quot;</span>]], <span class="st">&quot;map.order&quot;</span>) &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="kw">attr</span>(tmp[[<span class="st">&quot;tree&quot;</span>]], <span class="st">&quot;class&quot;</span>) &lt;-<span class="st"> &quot;phylo&quot;</span></a>
<a class="sourceLine" id="cb4-8" title="8">tmp[[<span class="st">&quot;read.counts&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">Ntip</span>(ph))</a>
<a class="sourceLine" id="cb4-9" title="9"><span class="kw">write.annotated.tree</span>(tmp, outfile, <span class="dt">format =</span> <span class="st">&quot;pdf&quot;</span>, <span class="dt">pdf.scale.bar.width =</span> <span class="fl">0.01</span>, <span class="dt">pdf.w =</span> <span class="dv">40</span>, <span class="dt">pdf.hm =</span> <span class="fl">0.2</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-10" title="10"></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co"># save phyloscanner.tree</span></a>
<a class="sourceLine" id="cb4-12" title="12">outfile &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;workspace</span><span class="ch">\\</span><span class="st">.rda&quot;</span>, <span class="st">&quot;annotated_dated_tree.rda&quot;</span>, infile)</a>
<a class="sourceLine" id="cb4-13" title="13"><span class="kw">save</span>(ph, <span class="dt">file =</span> outfile)</a></code></pre></div>
</div>
<div id="code-to-extract-king-county-subgraphs" class="section level2">
<h2>Code to extract King County subgraphs</h2>
<p>The following code chunk will:</p>
<ul>
<li>take a dated tree with ancestral state reconstructions</li>
<li>extract all King County subgraphs</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># phyloscanner label for transmission chains among heterosexual individuals in King County </span></a>
<a class="sourceLine" id="cb5-2" title="2">host &lt;-<span class="st"> &#39;KCHSX&#39;</span></a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co"># find the MRCAS of all King County subgraphs </span></a>
<a class="sourceLine" id="cb5-5" title="5">mrcas &lt;-<span class="st"> </span><span class="kw">which</span>( <span class="kw">attr</span>(ph, <span class="st">&#39;SUBGRAPH_MRCA&#39;</span>) )</a>
<a class="sourceLine" id="cb5-6" title="6">mrcas &lt;-<span class="st"> </span>mrcas[ <span class="kw">attr</span>(ph, <span class="st">&#39;INDIVIDUAL&#39;</span>)[mrcas]<span class="op">==</span>host ]   </a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co"># convert tree to class simmap</span></a>
<a class="sourceLine" id="cb5-8" title="8">ph &lt;-<span class="st"> </span><span class="kw">phyloscanner.to.simmap</span>(ph)</a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co"># extract subgraphs</span></a>
<a class="sourceLine" id="cb5-10" title="10">subgraphs &lt;-<span class="st"> </span><span class="kw">lapply</span>(mrcas, <span class="cf">function</span>(mrca) <span class="kw">extract.subgraph</span>(ph, mrca))</a>
<a class="sourceLine" id="cb5-11" title="11">subgraphs</a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt; [[1]]$edge</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt; [[1]]$edge.length</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-19" title="19"><span class="co">#&gt; [[1]]$Nnode</span></a>
<a class="sourceLine" id="cb5-20" title="20"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-21" title="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-22" title="22"><span class="co">#&gt; [[1]]$tip.label</span></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-016802-8161-king-Other-Asia-M-HSX_M-2008&quot;</span></a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="co">#&gt; [[1]]$maps</span></a>
<a class="sourceLine" id="cb5-26" title="26"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-27" title="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-28" title="28"><span class="co">#&gt; [[1]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-29" title="29"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-30" title="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-31" title="31"><span class="co">#&gt; [[1]]$node.states</span></a>
<a class="sourceLine" id="cb5-32" title="32"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-33" title="33"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-34" title="34"><span class="co">#&gt; [[1]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-35" title="35"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT1&quot;</span></a>
<a class="sourceLine" id="cb5-36" title="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-37" title="37"><span class="co">#&gt; [[1]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-38" title="38"><span class="co">#&gt; [1] 13.3315</span></a>
<a class="sourceLine" id="cb5-39" title="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-40" title="40"><span class="co">#&gt; [[1]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-41" title="41"><span class="co">#&gt; [1] &quot;Asia&quot;</span></a>
<a class="sourceLine" id="cb5-42" title="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-43" title="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-44" title="44"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb5-45" title="45"><span class="co">#&gt; [[2]]$edge</span></a>
<a class="sourceLine" id="cb5-46" title="46"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-47" title="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-48" title="48"><span class="co">#&gt; [[2]]$edge.length</span></a>
<a class="sourceLine" id="cb5-49" title="49"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-50" title="50"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-51" title="51"><span class="co">#&gt; [[2]]$Nnode</span></a>
<a class="sourceLine" id="cb5-52" title="52"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-53" title="53"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-54" title="54"><span class="co">#&gt; [[2]]$tip.label</span></a>
<a class="sourceLine" id="cb5-55" title="55"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-003362-5954-king-Other-Asia-F-HSX_F-2006&quot;</span></a>
<a class="sourceLine" id="cb5-56" title="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-57" title="57"><span class="co">#&gt; [[2]]$maps</span></a>
<a class="sourceLine" id="cb5-58" title="58"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-59" title="59"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-60" title="60"><span class="co">#&gt; [[2]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-61" title="61"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-62" title="62"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-63" title="63"><span class="co">#&gt; [[2]]$node.states</span></a>
<a class="sourceLine" id="cb5-64" title="64"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-65" title="65"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-66" title="66"><span class="co">#&gt; [[2]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-67" title="67"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT3&quot;</span></a>
<a class="sourceLine" id="cb5-68" title="68"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-69" title="69"><span class="co">#&gt; [[2]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-70" title="70"><span class="co">#&gt; [1] 4.158021</span></a>
<a class="sourceLine" id="cb5-71" title="71"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-72" title="72"><span class="co">#&gt; [[2]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-73" title="73"><span class="co">#&gt; [1] &quot;Asia&quot;</span></a>
<a class="sourceLine" id="cb5-74" title="74"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-75" title="75"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-76" title="76"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb5-77" title="77"><span class="co">#&gt; [[3]]$edge</span></a>
<a class="sourceLine" id="cb5-78" title="78"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-79" title="79"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-80" title="80"><span class="co">#&gt; [[3]]$edge.length</span></a>
<a class="sourceLine" id="cb5-81" title="81"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-82" title="82"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-83" title="83"><span class="co">#&gt; [[3]]$Nnode</span></a>
<a class="sourceLine" id="cb5-84" title="84"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-85" title="85"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-86" title="86"><span class="co">#&gt; [[3]]$tip.label</span></a>
<a class="sourceLine" id="cb5-87" title="87"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-001877-8355-king-Other-Asia-F-HSX_F-1998&quot;</span></a>
<a class="sourceLine" id="cb5-88" title="88"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-89" title="89"><span class="co">#&gt; [[3]]$maps</span></a>
<a class="sourceLine" id="cb5-90" title="90"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-91" title="91"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-92" title="92"><span class="co">#&gt; [[3]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-93" title="93"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-94" title="94"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-95" title="95"><span class="co">#&gt; [[3]]$node.states</span></a>
<a class="sourceLine" id="cb5-96" title="96"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-97" title="97"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-98" title="98"><span class="co">#&gt; [[3]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-99" title="99"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT4&quot;</span></a>
<a class="sourceLine" id="cb5-100" title="100"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-101" title="101"><span class="co">#&gt; [[3]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-102" title="102"><span class="co">#&gt; [1] 15.06137</span></a>
<a class="sourceLine" id="cb5-103" title="103"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-104" title="104"><span class="co">#&gt; [[3]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-105" title="105"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb5-106" title="106"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-107" title="107"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-108" title="108"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb5-109" title="109"><span class="co">#&gt; [[4]]$edge</span></a>
<a class="sourceLine" id="cb5-110" title="110"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-111" title="111"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-112" title="112"><span class="co">#&gt; [[4]]$edge.length</span></a>
<a class="sourceLine" id="cb5-113" title="113"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-114" title="114"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-115" title="115"><span class="co">#&gt; [[4]]$Nnode</span></a>
<a class="sourceLine" id="cb5-116" title="116"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-117" title="117"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-118" title="118"><span class="co">#&gt; [[4]]$tip.label</span></a>
<a class="sourceLine" id="cb5-119" title="119"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-001316-3567-king-Other-Asia-F-HSX_F-2002&quot;</span></a>
<a class="sourceLine" id="cb5-120" title="120"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-121" title="121"><span class="co">#&gt; [[4]]$maps</span></a>
<a class="sourceLine" id="cb5-122" title="122"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-123" title="123"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-124" title="124"><span class="co">#&gt; [[4]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-125" title="125"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-126" title="126"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-127" title="127"><span class="co">#&gt; [[4]]$node.states</span></a>
<a class="sourceLine" id="cb5-128" title="128"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-129" title="129"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-130" title="130"><span class="co">#&gt; [[4]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-131" title="131"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT5&quot;</span></a>
<a class="sourceLine" id="cb5-132" title="132"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-133" title="133"><span class="co">#&gt; [[4]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-134" title="134"><span class="co">#&gt; [1] 15.28131</span></a>
<a class="sourceLine" id="cb5-135" title="135"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-136" title="136"><span class="co">#&gt; [[4]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-137" title="137"><span class="co">#&gt; [1] &quot;Asia&quot;</span></a>
<a class="sourceLine" id="cb5-138" title="138"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-139" title="139"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-140" title="140"><span class="co">#&gt; [[5]]</span></a>
<a class="sourceLine" id="cb5-141" title="141"><span class="co">#&gt; [[5]]$edge</span></a>
<a class="sourceLine" id="cb5-142" title="142"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-143" title="143"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-144" title="144"><span class="co">#&gt; [[5]]$edge.length</span></a>
<a class="sourceLine" id="cb5-145" title="145"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-146" title="146"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-147" title="147"><span class="co">#&gt; [[5]]$Nnode</span></a>
<a class="sourceLine" id="cb5-148" title="148"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-149" title="149"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-150" title="150"><span class="co">#&gt; [[5]]$tip.label</span></a>
<a class="sourceLine" id="cb5-151" title="151"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-004447-13164-king-Other-Asia-F-HSX_F-2015&quot;</span></a>
<a class="sourceLine" id="cb5-152" title="152"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-153" title="153"><span class="co">#&gt; [[5]]$maps</span></a>
<a class="sourceLine" id="cb5-154" title="154"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-155" title="155"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-156" title="156"><span class="co">#&gt; [[5]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-157" title="157"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-158" title="158"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-159" title="159"><span class="co">#&gt; [[5]]$node.states</span></a>
<a class="sourceLine" id="cb5-160" title="160"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-161" title="161"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-162" title="162"><span class="co">#&gt; [[5]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-163" title="163"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT6&quot;</span></a>
<a class="sourceLine" id="cb5-164" title="164"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-165" title="165"><span class="co">#&gt; [[5]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-166" title="166"><span class="co">#&gt; [1] 13.49988</span></a>
<a class="sourceLine" id="cb5-167" title="167"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-168" title="168"><span class="co">#&gt; [[5]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-169" title="169"><span class="co">#&gt; [1] &quot;Asia&quot;</span></a>
<a class="sourceLine" id="cb5-170" title="170"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-171" title="171"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-172" title="172"><span class="co">#&gt; [[6]]</span></a>
<a class="sourceLine" id="cb5-173" title="173"><span class="co">#&gt; [[6]]$edge</span></a>
<a class="sourceLine" id="cb5-174" title="174"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-175" title="175"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-176" title="176"><span class="co">#&gt; [[6]]$edge.length</span></a>
<a class="sourceLine" id="cb5-177" title="177"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-178" title="178"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-179" title="179"><span class="co">#&gt; [[6]]$Nnode</span></a>
<a class="sourceLine" id="cb5-180" title="180"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-181" title="181"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-182" title="182"><span class="co">#&gt; [[6]]$tip.label</span></a>
<a class="sourceLine" id="cb5-183" title="183"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-022391-29735-king-Other-Asia-M-HSX_M-2018&quot;</span></a>
<a class="sourceLine" id="cb5-184" title="184"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-185" title="185"><span class="co">#&gt; [[6]]$maps</span></a>
<a class="sourceLine" id="cb5-186" title="186"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-187" title="187"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-188" title="188"><span class="co">#&gt; [[6]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-189" title="189"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-190" title="190"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-191" title="191"><span class="co">#&gt; [[6]]$node.states</span></a>
<a class="sourceLine" id="cb5-192" title="192"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-193" title="193"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-194" title="194"><span class="co">#&gt; [[6]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-195" title="195"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT7&quot;</span></a>
<a class="sourceLine" id="cb5-196" title="196"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-197" title="197"><span class="co">#&gt; [[6]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-198" title="198"><span class="co">#&gt; [1] 19.192</span></a>
<a class="sourceLine" id="cb5-199" title="199"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-200" title="200"><span class="co">#&gt; [[6]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-201" title="201"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb5-202" title="202"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-203" title="203"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-204" title="204"><span class="co">#&gt; [[7]]</span></a>
<a class="sourceLine" id="cb5-205" title="205"><span class="co">#&gt; [[7]]$edge</span></a>
<a class="sourceLine" id="cb5-206" title="206"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-207" title="207"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-208" title="208"><span class="co">#&gt; [[7]]$edge.length</span></a>
<a class="sourceLine" id="cb5-209" title="209"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-210" title="210"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-211" title="211"><span class="co">#&gt; [[7]]$Nnode</span></a>
<a class="sourceLine" id="cb5-212" title="212"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-213" title="213"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-214" title="214"><span class="co">#&gt; [[7]]$tip.label</span></a>
<a class="sourceLine" id="cb5-215" title="215"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-002536-9294-king-Hispanic-USA-F-HSX_F-2010&quot;</span></a>
<a class="sourceLine" id="cb5-216" title="216"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-217" title="217"><span class="co">#&gt; [[7]]$maps</span></a>
<a class="sourceLine" id="cb5-218" title="218"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-219" title="219"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-220" title="220"><span class="co">#&gt; [[7]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-221" title="221"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-222" title="222"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-223" title="223"><span class="co">#&gt; [[7]]$node.states</span></a>
<a class="sourceLine" id="cb5-224" title="224"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-225" title="225"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-226" title="226"><span class="co">#&gt; [[7]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-227" title="227"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT8&quot;</span></a>
<a class="sourceLine" id="cb5-228" title="228"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-229" title="229"><span class="co">#&gt; [[7]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-230" title="230"><span class="co">#&gt; [1] 4.42948</span></a>
<a class="sourceLine" id="cb5-231" title="231"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-232" title="232"><span class="co">#&gt; [[7]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-233" title="233"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb5-234" title="234"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-235" title="235"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-236" title="236"><span class="co">#&gt; [[8]]</span></a>
<a class="sourceLine" id="cb5-237" title="237"><span class="co">#&gt; [[8]]$edge</span></a>
<a class="sourceLine" id="cb5-238" title="238"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-239" title="239"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-240" title="240"><span class="co">#&gt; [[8]]$edge.length</span></a>
<a class="sourceLine" id="cb5-241" title="241"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-242" title="242"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-243" title="243"><span class="co">#&gt; [[8]]$Nnode</span></a>
<a class="sourceLine" id="cb5-244" title="244"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-245" title="245"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-246" title="246"><span class="co">#&gt; [[8]]$tip.label</span></a>
<a class="sourceLine" id="cb5-247" title="247"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-001776-13081-king-Other-Asia-M-HSX_M-2015&quot;</span></a>
<a class="sourceLine" id="cb5-248" title="248"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-249" title="249"><span class="co">#&gt; [[8]]$maps</span></a>
<a class="sourceLine" id="cb5-250" title="250"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-251" title="251"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-252" title="252"><span class="co">#&gt; [[8]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-253" title="253"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-254" title="254"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-255" title="255"><span class="co">#&gt; [[8]]$node.states</span></a>
<a class="sourceLine" id="cb5-256" title="256"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-257" title="257"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-258" title="258"><span class="co">#&gt; [[8]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-259" title="259"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT9&quot;</span></a>
<a class="sourceLine" id="cb5-260" title="260"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-261" title="261"><span class="co">#&gt; [[8]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-262" title="262"><span class="co">#&gt; [1] 6.068089</span></a>
<a class="sourceLine" id="cb5-263" title="263"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-264" title="264"><span class="co">#&gt; [[8]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-265" title="265"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb5-266" title="266"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-267" title="267"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-268" title="268"><span class="co">#&gt; [[9]]</span></a>
<a class="sourceLine" id="cb5-269" title="269"><span class="co">#&gt; [[9]]$edge</span></a>
<a class="sourceLine" id="cb5-270" title="270"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-271" title="271"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-272" title="272"><span class="co">#&gt; [[9]]$edge.length</span></a>
<a class="sourceLine" id="cb5-273" title="273"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-274" title="274"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-275" title="275"><span class="co">#&gt; [[9]]$Nnode</span></a>
<a class="sourceLine" id="cb5-276" title="276"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-277" title="277"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-278" title="278"><span class="co">#&gt; [[9]]$tip.label</span></a>
<a class="sourceLine" id="cb5-279" title="279"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-001209-6385-king-Other-Asia-F-HSX_F-2007&quot;</span></a>
<a class="sourceLine" id="cb5-280" title="280"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-281" title="281"><span class="co">#&gt; [[9]]$maps</span></a>
<a class="sourceLine" id="cb5-282" title="282"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-283" title="283"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-284" title="284"><span class="co">#&gt; [[9]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-285" title="285"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-286" title="286"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-287" title="287"><span class="co">#&gt; [[9]]$node.states</span></a>
<a class="sourceLine" id="cb5-288" title="288"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-289" title="289"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-290" title="290"><span class="co">#&gt; [[9]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-291" title="291"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT10&quot;</span></a>
<a class="sourceLine" id="cb5-292" title="292"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-293" title="293"><span class="co">#&gt; [[9]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-294" title="294"><span class="co">#&gt; [1] 12.72641</span></a>
<a class="sourceLine" id="cb5-295" title="295"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-296" title="296"><span class="co">#&gt; [[9]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-297" title="297"><span class="co">#&gt; [1] &quot;Asia&quot;</span></a>
<a class="sourceLine" id="cb5-298" title="298"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-299" title="299"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-300" title="300"><span class="co">#&gt; [[10]]</span></a>
<a class="sourceLine" id="cb5-301" title="301"><span class="co">#&gt; [[10]]$edge</span></a>
<a class="sourceLine" id="cb5-302" title="302"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-303" title="303"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-304" title="304"><span class="co">#&gt; [[10]]$edge.length</span></a>
<a class="sourceLine" id="cb5-305" title="305"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-306" title="306"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-307" title="307"><span class="co">#&gt; [[10]]$Nnode</span></a>
<a class="sourceLine" id="cb5-308" title="308"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-309" title="309"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-310" title="310"><span class="co">#&gt; [[10]]$tip.label</span></a>
<a class="sourceLine" id="cb5-311" title="311"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-014988-14192-king-Other-Asia-F-HSX_F-2016&quot;</span></a>
<a class="sourceLine" id="cb5-312" title="312"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-313" title="313"><span class="co">#&gt; [[10]]$maps</span></a>
<a class="sourceLine" id="cb5-314" title="314"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-315" title="315"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-316" title="316"><span class="co">#&gt; [[10]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-317" title="317"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-318" title="318"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-319" title="319"><span class="co">#&gt; [[10]]$node.states</span></a>
<a class="sourceLine" id="cb5-320" title="320"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-321" title="321"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-322" title="322"><span class="co">#&gt; [[10]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-323" title="323"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT11&quot;</span></a>
<a class="sourceLine" id="cb5-324" title="324"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-325" title="325"><span class="co">#&gt; [[10]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-326" title="326"><span class="co">#&gt; [1] 15.68682</span></a>
<a class="sourceLine" id="cb5-327" title="327"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-328" title="328"><span class="co">#&gt; [[10]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-329" title="329"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb5-330" title="330"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-331" title="331"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-332" title="332"><span class="co">#&gt; [[11]]</span></a>
<a class="sourceLine" id="cb5-333" title="333"><span class="co">#&gt; [[11]]$edge</span></a>
<a class="sourceLine" id="cb5-334" title="334"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-335" title="335"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-336" title="336"><span class="co">#&gt; [[11]]$edge.length</span></a>
<a class="sourceLine" id="cb5-337" title="337"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-338" title="338"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-339" title="339"><span class="co">#&gt; [[11]]$Nnode</span></a>
<a class="sourceLine" id="cb5-340" title="340"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-341" title="341"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-342" title="342"><span class="co">#&gt; [[11]]$tip.label</span></a>
<a class="sourceLine" id="cb5-343" title="343"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-017078-6490-king-Other-Asia-F-HSX_F-2006&quot;</span></a>
<a class="sourceLine" id="cb5-344" title="344"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-345" title="345"><span class="co">#&gt; [[11]]$maps</span></a>
<a class="sourceLine" id="cb5-346" title="346"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-347" title="347"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-348" title="348"><span class="co">#&gt; [[11]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-349" title="349"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-350" title="350"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-351" title="351"><span class="co">#&gt; [[11]]$node.states</span></a>
<a class="sourceLine" id="cb5-352" title="352"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-353" title="353"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-354" title="354"><span class="co">#&gt; [[11]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-355" title="355"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT12&quot;</span></a>
<a class="sourceLine" id="cb5-356" title="356"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-357" title="357"><span class="co">#&gt; [[11]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-358" title="358"><span class="co">#&gt; [1] 9.621026</span></a>
<a class="sourceLine" id="cb5-359" title="359"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-360" title="360"><span class="co">#&gt; [[11]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-361" title="361"><span class="co">#&gt; [1] &quot;Asia&quot;</span></a>
<a class="sourceLine" id="cb5-362" title="362"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-363" title="363"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-364" title="364"><span class="co">#&gt; [[12]]</span></a>
<a class="sourceLine" id="cb5-365" title="365"><span class="co">#&gt; [[12]]$edge</span></a>
<a class="sourceLine" id="cb5-366" title="366"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-367" title="367"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-368" title="368"><span class="co">#&gt; [[12]]$edge.length</span></a>
<a class="sourceLine" id="cb5-369" title="369"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-370" title="370"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-371" title="371"><span class="co">#&gt; [[12]]$Nnode</span></a>
<a class="sourceLine" id="cb5-372" title="372"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-373" title="373"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-374" title="374"><span class="co">#&gt; [[12]]$tip.label</span></a>
<a class="sourceLine" id="cb5-375" title="375"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-012435-10908-king-Other-Asia-F-HSX_F-2012&quot;</span></a>
<a class="sourceLine" id="cb5-376" title="376"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-377" title="377"><span class="co">#&gt; [[12]]$maps</span></a>
<a class="sourceLine" id="cb5-378" title="378"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-379" title="379"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-380" title="380"><span class="co">#&gt; [[12]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-381" title="381"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-382" title="382"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-383" title="383"><span class="co">#&gt; [[12]]$node.states</span></a>
<a class="sourceLine" id="cb5-384" title="384"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-385" title="385"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-386" title="386"><span class="co">#&gt; [[12]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-387" title="387"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT13&quot;</span></a>
<a class="sourceLine" id="cb5-388" title="388"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-389" title="389"><span class="co">#&gt; [[12]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-390" title="390"><span class="co">#&gt; [1] 16.08364</span></a>
<a class="sourceLine" id="cb5-391" title="391"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-392" title="392"><span class="co">#&gt; [[12]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-393" title="393"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb5-394" title="394"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-395" title="395"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-396" title="396"><span class="co">#&gt; [[13]]</span></a>
<a class="sourceLine" id="cb5-397" title="397"><span class="co">#&gt; [[13]]$edge</span></a>
<a class="sourceLine" id="cb5-398" title="398"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-399" title="399"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-400" title="400"><span class="co">#&gt; [[13]]$edge.length</span></a>
<a class="sourceLine" id="cb5-401" title="401"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-402" title="402"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-403" title="403"><span class="co">#&gt; [[13]]$Nnode</span></a>
<a class="sourceLine" id="cb5-404" title="404"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-405" title="405"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-406" title="406"><span class="co">#&gt; [[13]]$tip.label</span></a>
<a class="sourceLine" id="cb5-407" title="407"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-002615-10790-king-Other-Asia-F-HSX_F-2012&quot;</span></a>
<a class="sourceLine" id="cb5-408" title="408"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-409" title="409"><span class="co">#&gt; [[13]]$maps</span></a>
<a class="sourceLine" id="cb5-410" title="410"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-411" title="411"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-412" title="412"><span class="co">#&gt; [[13]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-413" title="413"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-414" title="414"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-415" title="415"><span class="co">#&gt; [[13]]$node.states</span></a>
<a class="sourceLine" id="cb5-416" title="416"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-417" title="417"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-418" title="418"><span class="co">#&gt; [[13]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-419" title="419"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT15&quot;</span></a>
<a class="sourceLine" id="cb5-420" title="420"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-421" title="421"><span class="co">#&gt; [[13]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-422" title="422"><span class="co">#&gt; [1] 19.93308</span></a>
<a class="sourceLine" id="cb5-423" title="423"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-424" title="424"><span class="co">#&gt; [[13]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-425" title="425"><span class="co">#&gt; [1] &quot;Asia&quot;</span></a>
<a class="sourceLine" id="cb5-426" title="426"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-427" title="427"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-428" title="428"><span class="co">#&gt; [[14]]</span></a>
<a class="sourceLine" id="cb5-429" title="429"><span class="co">#&gt; [[14]]$edge</span></a>
<a class="sourceLine" id="cb5-430" title="430"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-431" title="431"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-432" title="432"><span class="co">#&gt; [[14]]$edge.length</span></a>
<a class="sourceLine" id="cb5-433" title="433"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-434" title="434"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-435" title="435"><span class="co">#&gt; [[14]]$Nnode</span></a>
<a class="sourceLine" id="cb5-436" title="436"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-437" title="437"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-438" title="438"><span class="co">#&gt; [[14]]$tip.label</span></a>
<a class="sourceLine" id="cb5-439" title="439"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-000011-2623-king-Other-Asia-F-HSX_F-2000&quot;</span></a>
<a class="sourceLine" id="cb5-440" title="440"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-441" title="441"><span class="co">#&gt; [[14]]$maps</span></a>
<a class="sourceLine" id="cb5-442" title="442"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-443" title="443"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-444" title="444"><span class="co">#&gt; [[14]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-445" title="445"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-446" title="446"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-447" title="447"><span class="co">#&gt; [[14]]$node.states</span></a>
<a class="sourceLine" id="cb5-448" title="448"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-449" title="449"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-450" title="450"><span class="co">#&gt; [[14]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-451" title="451"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT16&quot;</span></a>
<a class="sourceLine" id="cb5-452" title="452"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-453" title="453"><span class="co">#&gt; [[14]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-454" title="454"><span class="co">#&gt; [1] 30.20028</span></a>
<a class="sourceLine" id="cb5-455" title="455"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-456" title="456"><span class="co">#&gt; [[14]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-457" title="457"><span class="co">#&gt; [1] &quot;Asia&quot;</span></a>
<a class="sourceLine" id="cb5-458" title="458"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-459" title="459"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-460" title="460"><span class="co">#&gt; [[15]]</span></a>
<a class="sourceLine" id="cb5-461" title="461"><span class="co">#&gt; [[15]]$edge</span></a>
<a class="sourceLine" id="cb5-462" title="462"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-463" title="463"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-464" title="464"><span class="co">#&gt; [[15]]$edge.length</span></a>
<a class="sourceLine" id="cb5-465" title="465"><span class="co">#&gt; numeric(0)</span></a>
<a class="sourceLine" id="cb5-466" title="466"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-467" title="467"><span class="co">#&gt; [[15]]$Nnode</span></a>
<a class="sourceLine" id="cb5-468" title="468"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb5-469" title="469"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-470" title="470"><span class="co">#&gt; [[15]]$tip.label</span></a>
<a class="sourceLine" id="cb5-471" title="471"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-001201-11788-king-Other-Asia-F-HSX_F-2013&quot;</span></a>
<a class="sourceLine" id="cb5-472" title="472"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-473" title="473"><span class="co">#&gt; [[15]]$maps</span></a>
<a class="sourceLine" id="cb5-474" title="474"><span class="co">#&gt; list()</span></a>
<a class="sourceLine" id="cb5-475" title="475"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-476" title="476"><span class="co">#&gt; [[15]]$mapped.edge</span></a>
<a class="sourceLine" id="cb5-477" title="477"><span class="co">#&gt; &lt;0 x 0 matrix&gt;</span></a>
<a class="sourceLine" id="cb5-478" title="478"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-479" title="479"><span class="co">#&gt; [[15]]$node.states</span></a>
<a class="sourceLine" id="cb5-480" title="480"><span class="co">#&gt;      [,1] [,2]</span></a>
<a class="sourceLine" id="cb5-481" title="481"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-482" title="482"><span class="co">#&gt; [[15]]$subgraph.name</span></a>
<a class="sourceLine" id="cb5-483" title="483"><span class="co">#&gt; [1] &quot;KCHSX-SPLIT17&quot;</span></a>
<a class="sourceLine" id="cb5-484" title="484"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-485" title="485"><span class="co">#&gt; [[15]]$subgraph.root.edge</span></a>
<a class="sourceLine" id="cb5-486" title="486"><span class="co">#&gt; [1] 0.5533755</span></a>
<a class="sourceLine" id="cb5-487" title="487"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-488" title="488"><span class="co">#&gt; [[15]]$subgraph.parent.state</span></a>
<a class="sourceLine" id="cb5-489" title="489"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb5-490" title="490"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-491" title="491"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-492" title="492"><span class="co">#&gt; [[16]]</span></a>
<a class="sourceLine" id="cb5-493" title="493"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-494" title="494"><span class="co">#&gt; Phylogenetic tree with 2 tips and 1 internal nodes.</span></a>
<a class="sourceLine" id="cb5-495" title="495"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-496" title="496"><span class="co">#&gt; Tip labels:</span></a>
<a class="sourceLine" id="cb5-497" title="497"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-013971-3940-king-Other-Asia-F-HSX_F-2003&quot; &quot;KCHSX___PR/RT-007209-5078-king-Other-Asia-M-HSX_M-2005&quot;</span></a>
<a class="sourceLine" id="cb5-498" title="498"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-499" title="499"><span class="co">#&gt; The tree includes a mapped, 1-state discrete character with states:</span></a>
<a class="sourceLine" id="cb5-500" title="500"><span class="co">#&gt;  KCHSX-SPLIT2</span></a>
<a class="sourceLine" id="cb5-501" title="501"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-502" title="502"><span class="co">#&gt; Rooted; includes branch lengths.</span></a>
<a class="sourceLine" id="cb5-503" title="503"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-504" title="504"><span class="co">#&gt; [[17]]</span></a>
<a class="sourceLine" id="cb5-505" title="505"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-506" title="506"><span class="co">#&gt; Phylogenetic tree with 3 tips and 2 internal nodes.</span></a>
<a class="sourceLine" id="cb5-507" title="507"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-508" title="508"><span class="co">#&gt; Tip labels:</span></a>
<a class="sourceLine" id="cb5-509" title="509"><span class="co">#&gt; [1] &quot;KCHSX___PR/RT-011435-13111-king-Other-Asia-M-HSX_M-2015&quot; &quot;KCHSX___PR/RT-015330-14549-king-Other-Asia-F-HSX_F-2016&quot; &quot;KCHSX___PR/RT-006453-21056-king-White-USA-M-HSX_M-1996&quot; </span></a>
<a class="sourceLine" id="cb5-510" title="510"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-511" title="511"><span class="co">#&gt; Rooted; includes branch lengths.</span></a></code></pre></div>
<p>Let us also save the output:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">outfile &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;_workspace&quot;</span>, <span class="kw">paste0</span>(<span class="st">&quot;_subgraphs_&quot;</span>, host), infile)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">save</span>(subgraphs, <span class="dt">file =</span> outfile)</a></code></pre></div>
</div>
<div id="notes" class="section level2">
<h2>Notes</h2>
<p>The vignette was generated with:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">require</span>(rmarkdown)  </a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">setwd</span>(<span class="st">&#39;~/git/Phyloscanner.R.utilities/vignettes&#39;</span>)</a>
<a class="sourceLine" id="cb7-3" title="3">infile &lt;-<span class="st"> &#39;Seattle.treedater.Rmd&#39;</span></a>
<a class="sourceLine" id="cb7-4" title="4">rmarkdown<span class="op">::</span><span class="kw">render</span>(infile)   </a></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
